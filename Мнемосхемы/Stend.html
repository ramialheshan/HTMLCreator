<HTML><HEAD>
<META content="text/html; charset=utf-8" http-equiv="Content-Type">
<SCRIPT>
 var arrayData = [[33,1,'ВолныДокритическиеResize.gif',645,55,0,'Уровень достиг докритического значения','SandyBrown'],[33,2,'ВолныКритическиеResize.gif',645,55,0,'Уровень достиг докритического значения<br>','Red'],[33,3,'Серый.gif',675,58,0,'Отказ датчика уровня','Red'],[33,4,'ДатчикОтказResize.gif',675,58,0,'Восстановлен датчик уровня','Blue'],[34,1,'ВолныДокритическиеResize.gif',645,55,0,'Температура достигла докритического значения<br>','SandyBrown'],[34,2,'ВолныКритическиеResize.gif',645,55,0,'Температура достигла критического значения<br><br>','Red'],[34,3,'Серый.gif',675,58,0,'Отказ датчика температуры','Red'],[34,4,'ДатчикОтказResize.gif',675,58,0,'Восстановление датчика температуры','Blue'],[35,1,'ВолныДокритическиеResize.gif',258,111,0,'Концентрация аммиака достигла докритического значения','SandyBrown'],[35,2,'ВолныКритическиеResize.gif',258,111,0,'Концентрация аммиака достигла критического значения<br>','Red'],[35,3,'Серый.gif',287,115,0,'Отказ датчика концентрации аммиака ','Red'],[35,4,'ДатчикОтказResize.gif',287,115,0,'Восстановлен датчик концентрации аммиака ','Blue'],[36,1,'ВолныДокритическиеResize.gif',368,114,0,'Концентрация оксида углеводорода достигла докритического значения','SandyBrown'],[36,2,'ВолныКритическиеResize.gif',368,114,0,'Концентрация оксида углеводорода достигла критического значения','Red'],[36,3,'Серый.gif',397,118,0,'Отказ датчика концентрации оксида углерода','Red'],[36,4,'ДатчикОтказResize.gif',397,118,0,'Восстановлен датчик концентрации оксида углерода','Blue'],[37,1,'ВолныДокритическиеResize.gif',478,117,0,'Концентрация хлора достигла докритического значения','SandyBrown'],[37,2,'ВолныКритическиеResize.gif',478,117,0,'Концентрация хлора достигла критического значения','Red'],[37,3,'Серый.gif',507,118,0,'Отказ датчика концентрации хлора','Red'],[37,4,'ДатчикОтказResize.gif',507,118,0,'Восстановлен датчик концентрации хлора','Blue'],[32,1,'ВолныДокритическиеResize.gif',255,290,0,'Концентрация углеводорода достигла докритического значения','SandyBrown'],[32,2,'ВолныКритическиеResize.gif',255,290,0,'Концентрация углеводорода достигла критического значения<br>','Red'],[32,3,'Серый.gif',285,292,0,'Отказ датчика концентрации углеводорода','Red'],[32,4,'ДатчикОтказResize.gif',285,292,0,'Восстановлен датчик концентрации углеводорода','Red'],[39,1,'ВолныДокритическиеResize.gif',382,255,0,'Концентрация нефтепродуктов достигла докритического значения','SandyBrown'],[39,2,'ВолныКритическиеResize.gif',382,255,0,'Концентрация нефтепродуктов достигла критического значения<br>','Red'],[39,3,'Серый.gif',412,256,0,'Отказ датчика концентрации нефтепродуктов ','Red'],[39,4,'ДатчикОтказResize.gif',412,256,0,'Восстановлен датчик концентрации нефтепродуктов','Blue'],[64,2,'DIO_Критический.gif',676,418,0,'Активирована кнопка DIO','Red'],[64,4,'DIO_Восстановлен.gif',676,418,0,'Деактивирована кнопка DIO','Blue'],[65,2,'DI1_Критический.gif',760,419,0,'Активирована кнопка DI1','Red'],[65,4,'DI1_Восстановлен.gif',760,419,0,'Деактивирована кнопка DI1<br>','Blue'],[66,2,'DI2_Критический.gif',678,436,0,'Активирована кнопка DI2<br>','Red'],[66,4,'DI2_Восстановлен.gif',678,436,0,'Деактивирована кнопка DI2','Blue'],[67,2,'DI3_Критический.gif',758,437,0,'Активирована кнопка DI3','Red'],[67,4,'DI3_Восстановлен.gif',758,437,0,'Деактивирована кнопка DI3','Blue'],[68,2,'DI4_Критический.gif',680,455,0,'Активирована кнопка DI4','Red'],[68,4,'DI4_Восстановлен.gif',680,455,0,'Деактивирована кнопка DI4','Blue'],[69,2,'DI5_Критический.gif',757,455,0,'Активирована кнопка DI5','Red'],[69,4,'DI5_Восстановлен.gif',757,455,0,'Деактивирована кнопка DI5','Blue'],[70,2,'DI6_Критический.gif',675,471,0,'Активирована кнопка DI6','Red'],[70,4,'DI6_Восстановлен.gif',675,471,0,'Деактивирована кнопка DI6','Blue'],[71,2,'DI7_Критический.gif',761,472,0,'Активирована кнопка DI7','Red'],[71,4,'DI7_Восстановлен.gif',761,472,0,'Деактивирована кнопка DI7<br>','Blue'],[72,2,'AIO_Критический.gif',667,495,0,'Активирована кнопка AIO','Red'],[72,4,'AI0_Восстановлен.gif',667,495,0,'Деактивирована кнопка AI0','Blue'],[74,2,'K1_Активация.gif',677,402,0,'Активация K1','Red'],[75,2,'K2_Активация.gif',757,402,0,'Активация K2','Red'],[14,3,'ММП_Отказ.gif',50,0,0,'Зафиксирован отказ ММП МКУ','Red'],[15,3,'ММП_Отказ.gif',50,0,0,'Зафиксирован отказ ММП БОУ','Red']];
//Метод: Получить параметры с адресной строки 
function getValueParametr(name) {
    name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regexS = "[\\?&]" + name + "=([^&#]*)";
    var regex = new RegExp(regexS);
    var results = regex.exec(window.location.href);
    if (results == null)
        return "";
    else
        return results[1];
}
//Метод: Поворот изображения
function Rotate(img, factor) {
    if (img != null) {
        /**
        * Get the rotation factor if any
        */
        img.rotation = 0;
        current = (img.rotation ? Number(img.rotation) : 0) + factor;
        if (factor >= 0) {
            var rotation = Math.PI * current / 180;
        } else {
            var rotation = Math.PI * (360 + current) / 180;
        }
        var costheta = Math.cos(current);
        var sintheta = Math.sin(current);
        // Interweb Explorer
        if (document.all && !window.opera) {
            img.style.filter = "progid:DXImageTransform.Microsoft.Matrix(M11=" + costheta + ",M12=" + (-sintheta) + ",M21=" + sintheta + ",M22=" + costheta + ",SizingMethod='auto expand')";
        } else {
            alert('Операция поворота изображения доступна для выполнения в броузере Internet Explorer');
        }
        img.rotation = current;
        return true;
    }
    else {
        alert("Запись датчика отсутствует");
        return false;
    }
}
//Метод: Поиск датчика в массиве и применение его параметров 
function GetDataSensor() {
    var Id = getValueParametr("ID");
    var S = getValueParametr("S");
    if (Id != "" & S != "") {
        for (var i = 0; i < arrayData.length; i++) {
            if (arrayData[i].length == undefined) {
                TransformSensor(arrayData[3], arrayData[4], arrayData[2], arrayData[5], arrayData[6], arrayData[7]);
                return;
            }
            else {
                var count = arrayData[i].length;
                for (var x = 0; x < count; x++) {
                    if (Id.toString() == arrayData[i][0].toString()) {
                        if (S.toString() == arrayData[i][1].toString()) {
                            TransformSensor(arrayData[i][3], arrayData[i][4], arrayData[i][2], arrayData[i][5], arrayData[i][6], arrayData[i][7]);
                            return;}}}}}
        var removeImage = document.getElementById('ImageDiv');
        if (removeImage != null) {
            removeImage.innerHTML = "";
        }
        
        var textAlarm = document.getElementById('AlarmText');
        var alarmCell = document.getElementById('AlarmTextCell');
        alarmCell.setAttribute("vAlign", "middle");
        alarmCell.setAttribute("Align", "center");
        textAlarm.innerHTML = "ТЕКСТ<br>СООБЩЕНИЯ";

        alert("Введенные данные не найдены в массиве датчиков");
    }
    else {
        var removeImage = document.getElementById('ImageDiv');
        if (removeImage!=null) {
            removeImage.innerHTML = "";
            
            var textAlarm = document.getElementById('AlarmText');
            var alarmCell = document.getElementById('AlarmTextCell');
            alarmCell.setAttribute("vAlign", "middle");
            alarmCell.setAttribute("Align", "center");
            textAlarm.innerHTML = "ТЕКСТ<br>СООБЩЕНИЯ";
           
            alert("Введите параметры для отображения датчика");
        }
    }
}
//Метод: Поиск датчика в массиве и применение его параметров 
function TransformSensor(x, y, path, rotat, AlarmText, textColor) {
    var element = document.getElementById('sensor');
    var element2 = document.getElementById('ImageDiv');
    if (element != null) {
        if (path!=null) {
            element.setAttribute('src', path.toString());
        }
        element.removeAttribute('width');
        element.removeAttribute('height');
        element.removeAttribute('rotation');

        var left = (document.all.ImageCell.clientWidth - document.all.Plan.clientWidth) / 2;
        var top = (document.all.ImageCell.clientHeight - document.all.Plan.clientHeight) / 2;

        var nValueLeft = parseInt(left) + parseInt(x);
        var nValueTop = parseInt(top) + parseInt(y);

        element2.style.left = nValueLeft;
        element2.style.top = nValueTop;

        Rotate(document.getElementById('sensor'), rotat);

        element.removeAttribute('width');
        element.removeAttribute('height');
        element.removeAttribute('rotation');

        var alarm = document.getElementById('AlarmText');
        alarm.style.color = textColor;

        var alarmCell = document.getElementById('AlarmTextCell');
        alarmCell.setAttribute("vAlign", "top");
        if (AlarmText != "" ) {
            alarm.innerHTML = "!!!ВНИМАНИЕ!!!<br>" + AlarmText;
        } else {
        alarm.innerHTML = " ТЕКСТ СООБЩЕНИЯ ПУСТ";
        }
        
    }
}</SCRIPT>
</HEAD>
<BODY onload=GetDataSensor() onresize=GetDataSensor()>
<TABLE id=tableMain border=1 cellPadding=10 width="100%" height="100%">
<TBODY>
<TR>
<TD id=ImageCell bgColor=#ffffff height="80%" align=center><IMG id=Plan src="FON.png"></TD>
<TD id=AlarmTextCell vAlign=top width="30%" align=center>
<H1 style="COLOR: sandybrown" id=AlarmText>!!!ВНИМАНИЕ!!!<BR>Уровень достиг докритического значения</H1></TD></TR></TBODY></TABLE>
<DIV style="POSITION: absolute; TOP: 97px; LEFT: 655px" id=ImageDiv><IMG style="FILTER: progid:DXImageTransform.Microsoft.Matrix(M11=1,M12=0,M21=0,M22=1,SizingMethod='auto expand')" id=sensor src="file:///D|/Рабочие файлы/Стенд/Мнемосхемы/ВолныДокритическиеResize.gif"></DIV></BODY></HTML>